<template>
  <div @click=${(e)=>{cl(e)}} data-em='${props.emo}' data-num='${props.num}' class="emoji">
    ${props.emoji}
  </div>
</template>
<style>
</style>
<script>
  export default (props, { $store, $f7, $update, $el, $, $onMounted }) => {
    console.log(props);

    let toastClose = $f7.toast.create({
      text: '–ù–∞–∂–º–∏—Ç–µ –µ—â—ë —Ä–∞–∑, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å',
      closeButton: true,
      closeButtonText: '–û–∫—Å'
    })
    toastClose.on('closeButtonClick', ()=>{
      $store.state.userData.teach.doubleClickEmoji=true
      $f7.emit('e-backp')
    })

    $f7.on('e-changeEmoji', ()=>{
      $update()
    })

    function cl(e) {

      let el = e.target
      console.log(props.role, el.classList);
      if (props.role=='carddd') { 
        if (el.classList.contains('active')) {
        $(el).removeClass('active')
        $store.state.appData.selectedEmoji = ''

        let toast = $f7.toast.create({
          icon: '<i class="f7-icons">üëç</i>',
          text: '–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∞–Ω–æ',
          position: 'center',
          horizontalPosition: 'center',
          closeTimeout: 2000
        })

        toast.open()
        $store.state.gf.vibrate('big success')

        $store.state.userData.teach.doubleClickEmoji=true
        $f7.emit('e-backp')
      } else {
        $(el.parentElement.querySelector('.active')).removeClass('active')
        el.classList.add("active")
        $store.state.appData.selectedEmoji = props.emo

        if (!$store.state.userData.teach.doubleClickEmoji) {
          setTimeout(() => {
            toastClose.open()
          }, 500);
        }
        }
      }else{
        $(el.parentElement.querySelector('.active')).removeClass('active')
        el.classList.add("active")
        $f7.emit('e-moodCardEmojiClicked', el)
      }


    }



    $onMounted(() => {
      var ell = $el.value[0]
      $f7.on('e-moodCardHold', () => {
        console.log(props.emo, $store.state.appData.selectedEmoji, ell);
        if (props.emo == $store.state.appData.selectedEmoji) {
          // debugger
          console.log('yessss', ell);

          ell.classList.add("active")
          console.log(ell.classList);

        }
      })
    })
    return $render;
  }
</script>