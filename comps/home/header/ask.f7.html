<template>
  <div class="ask" innerHTML=${text()}>

  </div>
</template>
<script>
  export default (props, {$store, $f7, $update, $el, $onMounted}) => {
    //Ð½ÑƒÐ¶Ð½Ñ‹ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¾Ñ‚: Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¼Ð» Ð²Ð¾Ð´Ñ‹, ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ¼Ð¾Ñ†Ð¸Ð¸
    let data = $store.state.userData;
    let waterT
    let moodT

    if ($store.state.appData.yourText.water==undefined) {
      waterT=waterF()
      moodT=moodF()

      $store.state.appData.yourText.water=waterT
      $store.state.appData.yourText.mood=moodT
    }

    $onMounted(()=>{
      waterT=waterF()
      moodT=moodF()

      $store.state.appData.yourText.water=waterT
      $store.state.appData.yourText.mood=moodT
    })

    let text = ()=>{
      

      return `${waterT}<br/>${moodT}`
    }

    function waterF(){
      if (data.water.todayMl==0) {
        return 'Ð’Ñ‹Ð¿ÐµÐ¹ Ñ‡ÑƒÑ‚ÑŒ-Ñ‡ÑƒÑ‚ÑŒ Ð²Ð¾Ð´Ñ‹.'
      }else{
        if (data.water.todayMl>=data.water.goal) {
        return 'Ð¢Ñ‹ Ð²Ñ‹Ð¿Ð¸Ð» Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð²Ð¾Ð´Ñ‹, Ð¼Ð¾Ð»Ð¾Ð´ÐµÑ†! ðŸ¤—'
      }else{
        if (+data.water.goal-+data.water.todayMl>+data.water.goal/3) {
          return 'ÐŸÐ¾Ð¿ÐµÐ¹ ÐµÑ‰Ñ‘ Ð²Ð¾Ð´Ð¸Ñ‡ÐºÐ¸.'
        }else{
          return 'ÐŸÐ¾Ð¿ÐµÐ¹ Ð²Ð¾Ð´Ð¸Ñ‡ÐºÐ¸, Ð¾ÑÑ‚Ð°Ð»Ð¾ÑÑŒ Ñ‡ÑƒÑ‚ÑŒ-Ñ‡ÑƒÑ‚ÑŒ!'
        }
      }
      }
    }

    function moodF(){
      if (data.mood.days.length>0) {
        if (new Date(data.mood.days[data.mood.days.length-1].date).getDate() == new Date().getDate() &&
      new Date(data.mood.days[data.mood.days.length-1].date).getMonth() == new Date().getMonth()) {
        return randStr(['Ðž.. Ñ‚Ð°Ðº Ð²Ð¾Ñ‚ ÐºÐ°ÐºÐ¾Ðµ Ñƒ Ñ‚ÐµÐ±Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ.', 'Ð‘Ð»Ð¸Ð½, Ñ‚Ñ‹ Ñ‚Ð°ÐºÐ¾Ð¹ Ð½ÐµÐ¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹..',
        'ÐœÐ¾Ð»Ð¾Ð´ÐµÑ†, Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°Ð¹ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸ÐµÂ â€”Â Ð±ÑƒÐ´ÐµÑ‚ Ñ‡Ñ‚Ð¾ Ð²ÑÐ¿Ð¾Ð¼Ð½Ð¸Ñ‚ÑŒ.'])
      }else if(new Date(data.mood.days[data.mood.days.length-1].date).getMonth() == new Date().getMonth() &&
      (new Date(data.mood.days[data.mood.days.length-1].date).getDate() == new Date().getDate()-1 || 
      new Date(data.mood.days[data.mood.days.length-1].date).getDate() == new Date().getDate()-2)){
        return randStr(['Ð Ð°ÑÑÐºÐ°Ð¶ÐµÑˆÑŒ ÑÐµÐ³Ð¾Ð´Ð½Ñ, ÐºÐ°Ðº Ð´ÐµÐ»Ð°?', 'Ð˜Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ð¾, ÐºÐ°Ðº Ñ‚Ñ‹ ÑÐµÐ³Ð¾Ð´Ð½Ñ'])
      }else{
        return randStr(['Ð”Ð°Ð²Ð½Ð¾ Ñ‚Ñ‹ Ð½Ð¸Ñ‡ÐµÐ³Ð¾ Ð½Ðµ Ñ€Ð°ÑÑÐºÐ°Ð·Ñ‹Ð²Ð°Ð»..', 'ÐŸÐ¾Ð¼Ð½Ð¸ÑˆÑŒ ÐºÐ°Ðº Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾ Ð±Ñ‹Ð»Ð¾ Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°Ñ‚ÑŒ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ?'])
      }
      }else{
        return 'ÐšÐ°Ðº Ñ‚Ñ‹ ÑÐµÐ±Ñ Ñ‡ÑƒÐ²ÑÑ‚Ð²ÑƒÐµÑˆÑŒ?'
      }
    }

    $f7.on('e-waterChange', ()=>{
      waterT=waterF()
      $store.state.appData.yourText.water=waterT
      $update()
    })
    $f7.on('e-moodWrited', ()=>{
      moodT=moodF()
      $store.state.appData.yourText.mood=moodT
      $update()
    })

    function randStr(arr){
      return arr[$store.state.gf.getRandomInRange(0, arr.length-1)]
    }
    return $render;
  }
</script>